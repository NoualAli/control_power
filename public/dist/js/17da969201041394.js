"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5677],{5677:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});var s=n(6828),a=n(2904),i=n(629),o=n(7565);const r={components:{ContentHeader:s.Z,ContentBody:a.Z},layout:"backend",middleware:["auth"],metaInfo:function(){return{title:"Suivi des réalisations des missions"}},data:function(){var t=this;return{rowSelected:null,campaignId:null,config:{data:null,columns:[{label:"CDC-ID",field:"campaign"},{label:"Référence",field:"reference"},{label:"Dre",field:"dre"},{label:"Agence",field:"agency"},{label:"Contrôle sur place par",field:"agency_controllers_str"},{label:"Date début",field:"start"},{label:"Date fin",field:"end"},{label:"Moyenne",field:"avg_score",hide:!(0,o.nu)(["dcp","cdcr","cc"]),methods:{style:function(t){var e=t.avg_score;return 1==e?"bg-success text-white text-bold":2==e?"bg-info text-white text-bold":3==e?"bg-warning text-bold":"bg-danger text-white text-bold"}}},{label:"État",field:"state",isHtml:!0,methods:{showField:function(t){var e="inProgress";return"EN COURS"==t.state?e="inProgress":"À RÉALISER"==t.state?e="todo":"RÉALISÉ"==t.state?e="done":"EN RETARD"==t.state?e="late":"Validé et envoyé"==t.state?e="validated":"En attente de validation"==t.state&&(e="wating-validation"),'<div class="container" title="'.concat(t.state,'">\n                  <div class="mission-state ').concat(e,'"></div>\n                </div>')}}},{label:"Taux de progression",field:"progress_status",methods:{showField:function(t){return t.progress_status+"%"}}}],actions:{show:function(e){return t.can("view_mission")},edit:function(e){return t.can("edit_mission")&&e.remaining_days_before_start>5},delete:function(e){return t.can("delete_mission")&&e.remaining_days_before_start>5}}}}},computed:(0,i.Se)({missions:"missions/paginated"}),created:function(){this.campaignId=this.$route.params.campaignId,this.initData()},methods:{initData:function(){var t=this;(this.$route.params.campaignId?this.$store.dispatch("missions/fetchPaginated",this.$route.params.campaignId):this.$store.dispatch("missions/fetchPaginated")).then((function(){return t.config.data=t.missions.paginated}))},show:function(t){this.$router.push({name:"mission",params:{missionId:t.id}})},edit:function(t){this.$router.push({name:"missions-edit",params:{missionId:t.id}})},destroy:function(t){var e=this;swal.confirm_destroy().then((function(n){n.isConfirmed&&api.delete("missions/"+t.id).then((function(t){t.data.status?(e.initData(),swal.toast_success(t.data.message)):swal.alert_error(t.data.message)})).catch((function(t){console.log(t)}))}))}}};const d=(0,n(1900).Z)(r,(function(){var t=this,e=t._self._c;return t.can("view_mission")?e("div",[t.campaignId?e("ContentHeader",{scopedSlots:t._u([{key:"actions",fn:function(){return[t.can("create_mission")?e("router-link",{staticClass:"btn btn-info",attrs:{to:{name:"missions-create",params:{campaignId:t.campaignId}}}},[t._v("\n        Ajouter\n      ")]):t._e()]},proxy:!0}],null,!1,188342256)}):t._e(),t._v(" "),e("ContentBody",[e("NLDatatable",{attrs:{namespace:"missions",config:t.config},on:{show:t.show,delete:t.destroy,edit:t.edit}})],1)],1):t._e()}),[],!1,null,null,null).exports}}]);