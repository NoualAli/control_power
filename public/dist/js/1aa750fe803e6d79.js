"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[348],{4291:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var i=r(1241),l=r(629),n=r(3169);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c={middleware:["auth"],layout:"backend",components:{NLDatatable:i.Z},metaInfo:function(){return{title:"Références PCF"}},data:function(){return{showFilters:!1,currentFamilly:null,currentDomain:null,currentProcess:null,config:{data:null,namespace:"references",state_key:"paginated",rowKey:"id",columns:[{label:"Famille",field:"familly_name",filterable:"familly_id"},{label:"Domaine",field:"domain_name",filterable:"domain_id"},{label:"Processus",field:"process_name",filterable:"process_id"},{label:"Point de contrôle",field:"control_point_name"}]}}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,l.Se)({pcf:"references/pcf",famillies:"famillies/all",domains:"famillies/domains",processes:"domains/processes"})),watch:{currentFamilly:function(e){e?this.$store.dispatch("famillies/fetchDomains",e):this.resetFilter(),this.currentDomain=null},currentDomain:function(e){e&&this.$store.dispatch("domains/fetchProcesses",e),this.currentProcess=null,this.filter(),this.getFilters()},currentProcess:function(e){e&&this.filter(),this.getFilters()}},created:function(){var e=this;(0,n.T)("Références PCF"),this.$store.dispatch("references/fetchPCF").then((function(){return e.config.data=e.pcf.pcf})),this.$store.dispatch("famillies/fetchAll")},methods:{resetFilter:function(){var e=this;this.currentFamilly=null,this.currentDomain=null,this.currentProcess=null,this.$store.dispatch("references/fetchPCF").then((function(){return e.config.data=e.pcf.pcf}))},getFilters:function(){return{familly_id:this.currentFamilly,domain_id:this.currentDomain,process_id:this.currentProcess}},filter:function(){var e=this;this.currentFamilly&&this.$store.dispatch("references/filterPCF",{famillyId:this.currentFamilly,domainId:this.currentDomain,process:this.currentProcess}).then((function(){return e.config.data=e.pcf.pcf}))}}};const o=(0,r(1900).Z)(c,(function(){var e,t,r,i,l,n=this,s=n._self._c;return s("div",[s("div",{staticClass:"d-flex justify-between align-center"},[s("div",[s("button",{staticClass:"btn btn-success has-icon",class:{"is-active":n.showFilters},on:{click:function(e){e.preventDefault(),n.showFilters=!n.showFilters}}},[s("div",{staticClass:"las la-filter icon"})])]),n._v(" "),s("div")]),n._v(" "),n.showFilters?s("div",{staticClass:"filter-bar"},[s("div",{staticClass:"grid mt-6"},[s("div",{staticClass:"col-12 col-lg-4"},[s("label",{staticClass:"form-label",attrs:{for:"filter-famillies"}},[n._v("Famille")]),n._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:n.currentFamilly,expression:"currentFamilly"}],staticClass:"nl-select",attrs:{name:"filter[familly_id]",id:"filter-famillies"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));n.currentFamilly=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[n._v("Filtre Famille")]),n._v(" "),n._l(null===(e=n.famillies)||void 0===e?void 0:e.all,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[n._v(n._s(e.name))])}))],2)]),n._v(" "),n.currentFamilly?s("div",{staticClass:"col-12 col-lg-4"},[s("label",{staticClass:"form-label",attrs:{for:"filter-domains"}},[n._v("Domaine")]),n._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:n.currentDomain,expression:"currentDomain"}],staticClass:"nl-select",attrs:{name:"filter[domain_id]",id:"filter-domains"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));n.currentDomain=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[n._v("Filtre Domaine")]),n._v(" "),n._l(null===(t=n.domains)||void 0===t||null===(r=t.domains)||void 0===r?void 0:r.data,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[n._v("\n            "+n._s(e.name)+"\n          ")])}))],2)]):n._e(),n._v(" "),n.currentDomain?s("div",{staticClass:"col-12 col-lg-4"},[s("label",{attrs:{for:"filter-processes"}},[n._v("Processus")]),n._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:n.currentProcess,expression:"currentProcess"}],staticClass:"nl-select",attrs:{name:"filter[process_id]",id:"filter-processes"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));n.currentProcess=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[n._v("Filtre Processus")]),n._v(" "),n._l(null===(i=n.processes)||void 0===i||null===(l=i.processes)||void 0===l?void 0:l.data,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[n._v("\n            "+n._s(e.name)+"\n          ")])}))],2)]):n._e()]),n._v(" "),s("button",{staticClass:"btn btn-danger",on:{click:n.resetFilter}},[n._v("\n      Annuler\n    ")])]):n._e(),n._v(" "),s("NLDatatable",{attrs:{config:n.config,filters:{familly_id:this.currentFamilly,domain_id:this.currentDomain,process_id:this.currentProcess}}})],1)}),[],!1,null,null,null).exports}}]);