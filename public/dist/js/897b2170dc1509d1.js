"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[465],{465:(s,n,t)=>{t.r(n),t.d(n,{default:()=>c});var i=t(1241),e=t(629),a=t(2661);function o(s,n){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable}))),t.push.apply(t,i)}return t}function l(s,n,t){return n in s?Object.defineProperty(s,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[n]=t,s}const r={layout:"backend",middleware:["auth"],components:{NLDatatable:i.Z},data:function(){return{rowSelected:null,config:{data:null,namespace:"missions",state_key:"processes",rowKey:"id",columns:[{label:"Famille",field:"familly"},{label:"Domaine",field:"domain"},{label:"Processus",field:"name"},{label:"Total points de contrôle",field:"control_points_count"}],actions:{show:!0}}}},breadcrumb:function(){var s,n;return{label:"Mission "+(null===(s=this.mission)||void 0===s||null===(n=s.current)||void 0===n?void 0:n.reference)}},computed:function(s){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){l(s,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))}))}return s}({},(0,e.Se)({mission:"missions/current",processes:"missions/processes"})),created:function(){this.initData()},methods:{initData:function(){var s=this;this.close(),this.$store.dispatch("missions/fetch",{missionId:this.$route.params.missionId}),this.$store.dispatch("missions/fetch",{missionId:this.$route.params.missionId,onlyProcesses:!0}).then((function(){return s.config.data=s.processes.processes}))},execute:function(s){this.$router.push({name:"missions-execute",params:{missionId:this.mission.current.id,processId:s.item.id}})},destroy:function(s){var n=this;swal.confirm_destroy().then((function(s){var t;s.isConfirmed&&a.Z.delete("missions/"+(null===(t=n.mission)||void 0===t?void 0:t.current.id)).then((function(s){s.data.status?(n.initData(),swal.toast_success(s.data.message)):swal.alert_error(s.data.message)})).catch((function(s){console.log(s)}))}))},show:function(s){this.rowSelected=s},close:function(){this.rowSelected=null}}};const c=(0,t(1900).Z)(r,(function(){var s,n,t,i,e,a,o,l,r,c,d,v,u,m,_,p,f,b,C,g,h,y,w,x,k,O,P,S,j=this,D=j._self._c;return D("ContentBody",{directives:[{name:"can",rawName:"v-can",value:"view_mission",expression:"'view_mission'"}]},[D("div",{staticClass:"d-flex justify-end align-center gap-3 my-2"},[D("router-link",{directives:[{name:"can",rawName:"v-can",value:"view_mission",expression:"'view_mission'"}],staticClass:"btn",attrs:{to:{name:"campaign",params:{campaignId:null===(s=j.mission)||void 0===s?void 0:s.current.campaign.id}}}},[j._v("\n      Campagne de contrôle\n    ")]),j._v(" "),(null===(n=j.mission)||void 0===n||null===(t=n.current)||void 0===t?void 0:t.remaining_days_before_start)>5?D("router-link",{directives:[{name:"can",rawName:"v-can",value:"edit_mission",expression:"'edit_mission'"}],staticClass:"btn btn-warning",attrs:{to:{name:"missions-edit",params:{missionId:null===(i=j.mission)||void 0===i?void 0:i.current.id}}}},[D("i",{staticClass:"las la-edit icon"})]):j._e()],1),j._v(" "),D("div",{staticClass:"box border-primary-dark border-1 mb-10"},[D("div",{staticClass:"grid gap-6"},[D("div",{staticClass:"col-4"},[D("div",{staticClass:"grid gap-6"},[D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Mission:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s(null===(e=j.mission)||void 0===e||null===(a=e.current)||void 0===a?void 0:a.reference)+"\n            ")])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              DRE:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s(null===(o=j.mission)||void 0===o||null===(l=o.current)||void 0===l?void 0:l.dre.full_name)+"\n            ")])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Agence:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s(null===(r=j.mission)||void 0===r||null===(c=r.current)||void 0===c?void 0:c.agency.full_name)+"\n            ")])])])]),j._v(" "),D("div",{staticClass:"col-4"},[D("div",{staticClass:"grid gap-6"},[D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Campagne:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s(null===(d=j.mission)||void 0===d||null===(v=d.current)||void 0===v?void 0:v.campaign.reference)+"\n            ")])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Début:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s((null===(u=j.mission)||void 0===u||null===(m=u.current)||void 0===m?void 0:m.start)+" / "+(null===(_=j.mission)||void 0===_||null===(p=_.current)||void 0===p?void 0:p.remaining_days_before_start_str))+"\n            ")])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Fin:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s((null===(f=j.mission)||void 0===f||null===(b=f.current)||void 0===b?void 0:b.end)+" / "+(null===(C=j.mission)||void 0===C||null===(g=C.current)||void 0===g?void 0:g.remaining_days_before_end_str))+"\n            ")])])])]),j._v(" "),D("div",{staticClass:"col-4"},[D("div",{staticClass:"grid gap-6"},[D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Contrôleurs:\n            ")]),j._v(" "),D("span",[D("ul",{staticClass:"d-inline-block ml-6"},j._l(null===(h=j.mission)||void 0===h||null===(y=h.current)||void 0===y?void 0:y.controllers,(function(s){return D("li",{key:"controller-"+s.id},[j._v("\n                  "+j._s(s.full_name)+"\n                ")])})),0)])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Avancement:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s((null===(w=j.mission)||void 0===w||null===(x=w.current)||void 0===x?void 0:x.realisation_percentage)||"0 %")+"\n            ")])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n              Statut:\n            ")]),j._v(" "),D("span",[j._v("\n              "+j._s(null===(k=j.mission)||void 0===k||null===(O=k.current)||void 0===O?void 0:O.state)+"\n            ")])])])]),j._v(" "),D("div",{staticClass:"col-12"},[D("span",{staticClass:"text-bold"},[j._v("\n          Note:\n        ")]),j._v(" "),D("span",[j._v("\n          "+j._s((null===(P=j.mission)||void 0===P||null===(S=P.current)||void 0===S?void 0:S.note)||"-")+"\n        ")])])])]),j._v(" "),D("h2",[j._v("Détails de la mission")]),j._v(" "),D("NLDatatable",{attrs:{config:j.config},on:{show:j.show},scopedSlots:j._u([{key:"actions",fn:function(s){return[D("button",{staticClass:"btn btn-info has-icon",on:{click:function(n){return n.stopPropagation(),j.execute(s)}}},[D("i",{staticClass:"las la-tasks icon"})])]}}])}),j._v(" "),D("NLModal",{attrs:{show:j.rowSelected},on:{close:j.close},scopedSlots:j._u([{key:"title",fn:function(){var s,n,t;return[D("small",{staticClass:"tag is-info text-small"},[j._v("\n        "+j._s(null===(s=j.rowSelected)||void 0===s?void 0:s.familly)+"\n      ")]),j._v(" "),D("small",{staticClass:"tag is-primary-dark text-small mx-1"},[j._v("\n        "+j._s(null===(n=j.rowSelected)||void 0===n?void 0:n.domain)+"\n      ")]),j._v(" "),D("small",{staticClass:"tag is-warning text-small"},[j._v("\n        "+j._s(null===(t=j.rowSelected)||void 0===t?void 0:t.name)+"\n      ")])]},proxy:!0},{key:"default",fn:function(){var s;return[D("p",{staticClass:"text-bold mb-6"},[j._v("\n        Points de contrôle\n      ")]),j._v(" "),D("div",{staticClass:"grid list"},j._l(null===(s=j.rowSelected)||void 0===s?void 0:s.controlPoints,(function(s){return D("div",{key:s.id,staticClass:"col-12 list-item"},[D("div",{staticClass:"list-item-content"},[j._v("\n            "+j._s(s.name)+"\n          ")])])})),0)]},proxy:!0},{key:"footer",fn:function(){return[D("button",{staticClass:"btn btn-info has-icon",on:{click:function(s){return s.stopPropagation(),j.execute(j.rowSelected)}}},[D("i",{staticClass:"las la-tasks icon"}),j._v("\n        Éffectuer\n      ")])]},proxy:!0}])})],1)}),[],!1,null,null,null).exports}}]);