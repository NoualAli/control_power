"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2616],{2616:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var n=s(6828),i=s(2904),a=s(629);const o={components:{ContentHeader:n.Z,ContentBody:i.Z},layout:"backend",middleware:["auth"],metaInfo:function(){return{title:"Suivi des réalisations des missions"}},data:function(){return{rowSelected:null,campaignId:null,config:{data:null,columns:[{label:"CDC-ID",field:"campaign"},{label:"Référence",field:"reference"},{label:"Dre",field:"dre"},{label:"Agence",field:"agency"},{label:"Contrôle sur place par",field:"agency_controllers_str"},{label:"Date début",field:"start"},{label:"Date fin",field:"end"},{label:"Moyenne",field:"avg_score",methods:{style:function(e){var t=e.avg_score;return 1==t?"bg-success text-white text-bold":2==t?"bg-info text-white text-bold":3==t?"bg-warning text-bold":"bg-danger text-white text-bold"}}},{label:"État",field:"state",isHtml:!0,methods:{showField:function(e){var t="inProgress";return"EN COURS"==e.state?t="inProgress":"À RÉALISER"==e.state?t="todo":"RÉALISÉ"==e.state?t="done":"EN RETARD"==e.state?t="late":"Validé et envoyé"==e.state?t="validated":"En attente de validation"==e.state&&(t="wating-validation"),'<div class="container" title="'.concat(e.state,'">\n                  <div class="mission-state ').concat(t,'"></div>\n                </div>')}}},{label:"Progression",field:"progress_status",methods:{showField:function(e){return e.progress_status+"%"}}}],actions:{show:function(e){return user().authorizations.view_mission},edit:function(e){return user().authorizations.edit_mission&&e.remaining_days_before_start>5},delete:function(e){return user().authorizations.delete_mission&&e.remaining_days_before_start>5}}}}},computed:(0,a.Se)({missions:"missions/paginated"}),created:function(){this.campaignId=this.$route.params.campaignId,this.initData()},methods:{initData:function(){var e=this;(this.$route.params.campaignId?this.$store.dispatch("missions/fetchPaginated",this.$route.params.campaignId):this.$store.dispatch("missions/fetchPaginated")).then((function(){return e.config.data=e.missions.paginated}))},show:function(e){this.$router.push({name:"mission",params:{missionId:e.id}})},edit:function(e){this.$router.push({name:"missions-edit",params:{missionId:e.id}})},destroy:function(e){var t=this;swal.confirm_destroy().then((function(s){s.isConfirmed&&api.delete("missions/"+e.id).then((function(e){e.data.status?(t.initData(),swal.toast_success(e.data.message)):swal.alert_error(e.data.message)})).catch((function(e){console.log(e)}))}))}}};const r=(0,s(1900).Z)(o,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"can",rawName:"v-can",value:"view_mission",expression:"'view_mission'"}]},[e.campaignId?t("ContentHeader",{scopedSlots:e._u([{key:"actions",fn:function(){return[t("router-link",{directives:[{name:"can",rawName:"v-can",value:"create_mission",expression:"'create_mission'"}],staticClass:"btn btn-info",attrs:{to:{name:"missions-create",params:{campaignId:e.campaignId}}}},[e._v("\n        Ajouter\n      ")])]},proxy:!0}],null,!1,1288940108)}):e._e(),e._v(" "),t("ContentBody",[t("NLDatatable",{attrs:{namespace:"missions",config:e.config},on:{show:e.show,delete:e.destroy,edit:e.edit}})],1)],1)}),[],!1,null,null,null).exports}}]);