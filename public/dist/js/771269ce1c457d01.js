"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1605],{1605:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var i=r(2097),n=r(629),l=r(3169);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===s(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c={middleware:["auth"],layout:"backend",components:{NLDatatable:i.Z},metaInfo:function(){return{title:"Références PCF"}},data:function(){return{showFilters:!1,currentFamilly:null,currentDomain:null,currentProcess:null,config:{data:null,columns:[{label:"Famille",field:"familly_name",filterable:"familly_id"},{label:"Domaine",field:"domain_name",filterable:"domain_id"},{label:"Processus",field:"process_name",filterable:"process_id"},{label:"Point de contrôle",field:"control_point_name"}]}}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,n.Se)({pcf:"references/pcf",famillies:"famillies/all",domains:"famillies/domains",processes:"domains/processes"})),watch:{currentFamilly:function(e){e?this.$store.dispatch("famillies/fetchDomains",e):this.resetFilter(),this.currentDomain=null},currentDomain:function(e){e&&this.$store.dispatch("domains/fetchProcesses",e),this.currentProcess=null,this.filter(),this.getFilters()},currentProcess:function(e){e&&this.filter(),this.getFilters()}},created:function(){var e=this;(0,l.T)("Références PCF"),this.$store.dispatch("references/fetchPCF").then((function(){return e.config.data=e.pcf.pcf})),this.$store.dispatch("famillies/fetchAll")},methods:{resetFilter:function(){var e=this;this.currentFamilly=null,this.currentDomain=null,this.currentProcess=null,this.$store.dispatch("references/fetchPCF").then((function(){return e.config.data=e.pcf.pcf}))},getFilters:function(){return{familly_id:this.currentFamilly,domain_id:this.currentDomain,process_id:this.currentProcess}},filter:function(){var e=this;this.currentFamilly&&this.$store.dispatch("references/filterPCF",{famillyId:this.currentFamilly,domainId:this.currentDomain,process:this.currentProcess}).then((function(){return e.config.data=e.pcf.pcf}))}}};const u=(0,r(1900).Z)(c,(function(){var e,t,r,i,n,l=this,s=l._self._c;return s("div",[s("div",{staticClass:"d-flex justify-between align-center"},[s("div",[s("button",{staticClass:"btn btn-success has-icon",class:{"is-active":l.showFilters},on:{click:function(e){e.preventDefault(),l.showFilters=!l.showFilters}}},[s("div",{staticClass:"las la-filter icon"})])]),l._v(" "),s("div")]),l._v(" "),l.showFilters?s("div",{staticClass:"filter-bar"},[s("div",{staticClass:"grid mt-6"},[s("div",{staticClass:"col-12 col-lg-4"},[s("label",{staticClass:"form-label",attrs:{for:"filter-famillies"}},[l._v("Famille")]),l._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:l.currentFamilly,expression:"currentFamilly"}],staticClass:"nl-select",attrs:{name:"filter[familly_id]",id:"filter-famillies"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));l.currentFamilly=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[l._v("Filtre Famille")]),l._v(" "),l._l(null===(e=l.famillies)||void 0===e?void 0:e.all,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[l._v(l._s(e.name))])}))],2)]),l._v(" "),l.currentFamilly?s("div",{staticClass:"col-12 col-lg-4"},[s("label",{staticClass:"form-label",attrs:{for:"filter-domains"}},[l._v("Domaine")]),l._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:l.currentDomain,expression:"currentDomain"}],staticClass:"nl-select",attrs:{name:"filter[domain_id]",id:"filter-domains"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));l.currentDomain=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[l._v("Filtre Domaine")]),l._v(" "),l._l(null===(t=l.domains)||void 0===t||null===(r=t.domains)||void 0===r?void 0:r.data,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[l._v("\n            "+l._s(e.name)+"\n          ")])}))],2)]):l._e(),l._v(" "),l.currentDomain?s("div",{staticClass:"col-12 col-lg-4"},[s("label",{attrs:{for:"filter-processes"}},[l._v("Processus")]),l._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:l.currentProcess,expression:"currentProcess"}],staticClass:"nl-select",attrs:{name:"filter[process_id]",id:"filter-processes"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));l.currentProcess=e.target.multiple?t:t[0]}}},[s("option",{attrs:{value:"",seleted:"selected"}},[l._v("Filtre Processus")]),l._v(" "),l._l(null===(i=l.processes)||void 0===i||null===(n=i.processes)||void 0===n?void 0:n.data,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[l._v("\n            "+l._s(e.name)+"\n          ")])}))],2)]):l._e()]),l._v(" "),s("button",{staticClass:"btn btn-danger",on:{click:l.resetFilter}},[l._v("\n      Annuler\n    ")])]):l._e(),l._v(" "),s("NLDatatable",{attrs:{namespace:"references",config:l.config,filters:{familly_id:this.currentFamilly,domain_id:this.currentDomain,process_id:this.currentProcess}}})],1)}),[],!1,null,null,null).exports}}]);