"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[763],{3763:(n,t,a)=>{a.r(t),a.d(t,{default:()=>l});var e=a(1241),i=a(629),s=a(2661);function o(n,t){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.push.apply(a,e)}return a}function r(n,t,a){return t in n?Object.defineProperty(n,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[t]=a,n}const c={layout:"backend",middleware:["auth"],components:{NLDatatable:e.Z},breadcrumb:function(){var n;return{label:"Détails campagne "+(null===(n=this.campaign)||void 0===n?void 0:n.current.reference)}},data:function(){return{rowSelected:null,config:{data:null,namespace:"campaigns",state_key:"current",rowKey:"id",columns:[{label:"Famille",field:"familly_name"},{label:"Domaine",field:"domain_name"},{label:"Processus",field:"name"},{label:"Total points de contrôle",field:"control_points_count"}],actions:{show:!0}}}},computed:function(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(n,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))}))}return n}({},(0,i.Se)({processes:"campaigns/processes",process:"processes/controlPoints",campaign:"campaigns/current"})),created:function(){this.initData()},methods:{initData:function(){var n=this;this.close();var t=this.$route.params.campaignId;this.$store.dispatch("campaigns/fetch",{campaignId:t}),this.$store.dispatch("campaigns/fetchProcesses",t).then((function(){return n.config.data=n.processes.processes}))},loadControlPoints:function(n){var t=this;this.$store.dispatch("processes/fetch",{id:n.id,onlyControlPoints:!0}).then((function(){return t.control_points=t.process.controlPoints}))},destroy:function(){var n=this;swal.confirm_destroy().then((function(t){var a;t.isConfirmed&&s.Z.delete("campaigns/"+(null===(a=n.campaign)||void 0===a?void 0:a.current.id)).then((function(t){t.data.status?(swal.toast_success(t.data.message),n.$router.push({name:"campaigns"})):swal.alert_error(t.data.message)})).catch((function(n){console.log(n)}))}))},detachProcess:function(n){var t=this;swal.confirm_destroy().then((function(a){var e;a.isConfirmed&&s.Z.delete("campaigns/"+(null===(e=t.campaign)||void 0===e?void 0:e.current.id)+"/process/"+n.id).then((function(n){n.data.status?(t.initData(),swal.toast_success(n.data.message)):swal.alert_error(n.data.message)})).catch((function(n){console.log(n)}))}))},show:function(n){this.rowSelected=n,this.loadControlPoints(n)},close:function(){this.rowSelected=null}}};const l=(0,a(1900).Z)(c,(function(){var n,t,a,e,i,s,o,r,c,l,d,u,v,p,m,_,g,f,b,h,y=this,w=y._self._c;return w("ContentBody",{directives:[{name:"can",rawName:"v-can",value:"view_control_campaign",expression:"'view_control_campaign'"}]},[w("div",{staticClass:"d-flex justify-end align-center gap-3 my-2"},[w("router-link",{directives:[{name:"can",rawName:"v-can",value:"view_mission",expression:"'view_mission'"}],staticClass:"btn",attrs:{to:{name:"campaign-missions",params:{campaignId:null===(n=y.campaign)||void 0===n?void 0:n.current.id}}}},[y._v("\n      Missions\n    ")]),y._v(" "),(null===(t=y.campaign)||void 0===t||null===(a=t.current)||void 0===a?void 0:a.remaining_days_before_start)>5?w("router-link",{directives:[{name:"can",rawName:"v-can",value:"edit_control_campaign",expression:"'edit_control_campaign'"}],staticClass:"btn btn-warning",attrs:{to:{name:"campaigns-edit",params:{campaignId:null===(e=y.campaign)||void 0===e?void 0:e.current.id}}}},[w("i",{staticClass:"las la-edit icon"})]):y._e(),y._v(" "),(null===(i=y.campaign)||void 0===i||null===(s=i.current)||void 0===s?void 0:s.remaining_days_before_start)>5?w("button",{directives:[{name:"can",rawName:"v-can",value:"delete_control_campaign",expression:"'delete_control_campaign'"}],staticClass:"btn btn-danger",on:{click:function(n){return n.stopPropagation(),y.destroy.apply(null,arguments)}}},[w("i",{staticClass:"las la-trash icon"})]):y._e()],1),y._v(" "),w("div",{staticClass:"box mb-10 border-primary-dark border-1"},[w("div",{staticClass:"grid gap-12"},[w("div",{staticClass:"col-12 col-lg-6"},[w("span",{staticClass:"text-bold"},[y._v("\n          Référence:\n        ")]),y._v(" "),w("span",{staticClass:"text-bold"},[y._v("\n          "+y._s(null===(o=y.campaign)||void 0===o||null===(r=o.current)||void 0===r?void 0:r.reference)+"\n        ")])]),y._v(" "),w("div",{staticClass:"col-12 col-lg-6"},[w("div",{staticClass:"grid"},[w("div",{staticClass:"col-12 grid"},[w("div",{staticClass:"col-12 col-lg-6"},[w("span",{staticClass:"text-bold"},[y._v("\n                Début:\n              ")]),y._v(" "),w("span",[y._v("\n                "+y._s((null===(c=y.campaign)||void 0===c||null===(l=c.current)||void 0===l?void 0:l.start)+" / "+(null===(d=y.campaign)||void 0===d||null===(u=d.current)||void 0===u?void 0:u.remaining_days_before_start_str))+"\n              ")])]),y._v(" "),w("div",{staticClass:"col-12 col-lg-6"},[w("span",{staticClass:"text-bold"},[y._v("\n                Fin:\n              ")]),y._v(" "),w("span",[y._v("\n                "+y._s((null===(v=y.campaign)||void 0===v||null===(p=v.current)||void 0===p?void 0:p.end)+" / "+(null===(m=y.campaign)||void 0===m||null===(_=m.current)||void 0===_?void 0:_.remaining_days_before_end_str))+"\n              ")])])])])]),y._v(" "),w("div",{staticClass:"col-12"},[w("span",{staticClass:"text-bold"},[y._v("\n          Description:\n        ")]),y._v(" "),w("span",[y._v("\n          "+y._s(null===(g=y.campaign)||void 0===g||null===(f=g.current)||void 0===f?void 0:f.description)+"\n        ")])])])]),y._v(" "),w("NLDatatable",{attrs:{config:y.config},on:{show:y.show,delete:y.destroy},scopedSlots:y._u([{key:"actions",fn:function(n){var t,a;return[(null===(t=y.campaign)||void 0===t||null===(a=t.current)||void 0===a?void 0:a.remaining_days_before_start)>5?w("button",{directives:[{name:"can",rawName:"v-can",value:"edit_control_campaign",expression:"'edit_control_campaign'"}],staticClass:"btn btn-danger has-icon",on:{click:function(t){return t.stopPropagation(),y.detachProcess(n.item)}}},[w("i",{staticClass:"las la-unlink icon"})]):y._e()]}}])}),y._v(" "),w("NLModal",{attrs:{show:y.rowSelected},on:{close:y.close},scopedSlots:y._u([{key:"title",fn:function(){var n,t,a;return[w("small",{staticClass:"tag is-info text-small"},[y._v("\n        "+y._s(null===(n=y.rowSelected)||void 0===n?void 0:n.familly_name)+"\n      ")]),y._v(" "),w("small",{staticClass:"tag is-primary-dark text-small mx-1"},[y._v("\n        "+y._s(null===(t=y.rowSelected)||void 0===t?void 0:t.domain_name)+"\n      ")]),y._v(" "),w("small",{staticClass:"tag is-warning text-small"},[y._v("\n        "+y._s(null===(a=y.rowSelected)||void 0===a?void 0:a.name)+"\n      ")])]},proxy:!0},{key:"default",fn:function(){var n;return[w("p",{staticClass:"text-bold mb-6"},[y._v("\n        Points de contrôle\n      ")]),y._v(" "),w("div",{staticClass:"grid list"},y._l(null===(n=y.process)||void 0===n?void 0:n.controlPoints,(function(n){return w("div",{key:n.id,staticClass:"col-12 list-item"},[w("div",{staticClass:"list-item-content"},[y._v("\n            "+y._s(n.label)+"\n          ")])])})),0)]},proxy:!0},(null===(b=y.campaign)||void 0===b||null===(h=b.current)||void 0===h?void 0:h.remaining_days_before_start)>5?{key:"footer",fn:function(){return[w("button",{staticClass:"btn btn-danger has-icon",on:{click:function(n){var t;return n.stopPropagation(),y.destroy(y.rowSelected,null===(t=y.campaign)||void 0===t?void 0:t.current)}}},[w("i",{staticClass:"las la-unlink icon"}),y._v("\n        Détacher\n      ")])]},proxy:!0}:null],null,!0)})],1)}),[],!1,null,null,null).exports}}]);