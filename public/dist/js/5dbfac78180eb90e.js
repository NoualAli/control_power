"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8282],{5714:(t,e,s)=>{s.d(e,{ZP:()=>w,l0:()=>g});var a=s(9669),r=s.n(a),i=Object.defineProperty,o=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,c=(t,e,s)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,d=(t,e)=>{for(var s in e||(e={}))o.call(e,s)&&c(t,s,e[s]);if(n)for(var s of n(e))l.call(e,s)&&c(t,s,e[s]);return t};const u=t=>void 0===t,m=t=>Array.isArray(t),f=t=>t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.slice,p=(t,e,s,a)=>((e=e||{}).indices=!u(e.indices)&&e.indices,e.nullsAsUndefineds=!u(e.nullsAsUndefineds)&&e.nullsAsUndefineds,e.booleansAsIntegers=!u(e.booleansAsIntegers)&&e.booleansAsIntegers,e.allowEmptyArrays=!u(e.allowEmptyArrays)&&e.allowEmptyArrays,s=s||new FormData,u(t)||(null===t?e.nullsAsUndefineds||s.append(a,""):(t=>"boolean"==typeof t)(t)?e.booleansAsIntegers?s.append(a,t?1:0):s.append(a,t):m(t)?t.length?t.forEach(((t,r)=>{const i=a+"["+(e.indices?r:"")+"]";p(t,e,s,i)})):e.allowEmptyArrays&&s.append(a+"[]",""):(t=>t instanceof Date)(t)?s.append(a,t.toISOString()):!(t=>t===Object(t))(t)||(t=>f(t)&&"string"==typeof t.name&&("object"==typeof t.lastModifiedDate||"number"==typeof t.lastModified))(t)||f(t)?s.append(a,t):Object.keys(t).forEach((r=>{const i=t[r];if(m(i))for(;r.length>2&&r.lastIndexOf("[]")===r.length-2;)r=r.substring(0,r.length-2);p(i,e,s,a?a+"["+r+"]":r)}))),s);var v={serialize:p};function h(t){if(null===t||"object"!=typeof t)return t;const e=Array.isArray(t)?[]:{};return Object.keys(t).forEach((s=>{e[s]=h(t[s])})),e}function _(t){return Array.isArray(t)?t:[t]}function y(t){return t instanceof File||t instanceof Blob||t instanceof FileList||"object"==typeof t&&null!==t&&void 0!==Object.values(t).find((t=>y(t)))}class b{constructor(){this.errors={},this.errors={}}set(t,e){"object"==typeof t?this.errors=t:this.set(d(d({},this.errors),{[t]:_(e)}))}all(){return this.errors}has(t){return Object.prototype.hasOwnProperty.call(this.errors,t)}hasAny(...t){return t.some((t=>this.has(t)))}any(){return Object.keys(this.errors).length>0}get(t){if(this.has(t))return this.getAll(t)[0]}getAll(t){return _(this.errors[t]||[])}only(...t){const e=[];return t.forEach((t=>{const s=this.get(t);s&&e.push(s)})),e}flatten(){return Object.values(this.errors).reduce(((t,e)=>t.concat(e)),[])}clear(t){const e={};t&&Object.keys(this.errors).forEach((s=>{s!==t&&(e[s]=this.errors[s])})),this.set(e)}}class g{constructor(t={}){this.originalData={},this.busy=!1,this.successful=!1,this.recentlySuccessful=!1,this.recentlySuccessfulTimeoutId=void 0,this.errors=new b,this.progress=void 0,this.update(t)}static make(t){return new this(t)}update(t){this.originalData=Object.assign({},this.originalData,h(t)),Object.assign(this,t)}fill(t={}){this.keys().forEach((e=>{this[e]=t[e]}))}data(){return this.keys().reduce(((t,e)=>d(d({},t),{[e]:this[e]})),{})}keys(){return Object.keys(this).filter((t=>!g.ignore.includes(t)))}startProcessing(){this.errors.clear(),this.busy=!0,this.successful=!1,this.progress=void 0,this.recentlySuccessful=!1,clearTimeout(this.recentlySuccessfulTimeoutId)}finishProcessing(){this.busy=!1,this.successful=!0,this.progress=void 0,this.recentlySuccessful=!0,this.recentlySuccessfulTimeoutId=setTimeout((()=>{this.recentlySuccessful=!1}),g.recentlySuccessfulTimeout)}clear(){this.errors.clear(),this.successful=!1,this.recentlySuccessful=!1,this.progress=void 0,clearTimeout(this.recentlySuccessfulTimeoutId)}reset(){Object.keys(this).filter((t=>!g.ignore.includes(t))).forEach((t=>{this[t]=h(this.originalData[t])}))}get(t,e={}){return this.submit("get",t,e)}post(t,e={}){return this.submit("post",t,e)}patch(t,e={}){return this.submit("patch",t,e)}put(t,e={}){return this.submit("put",t,e)}delete(t,e={}){return this.submit("delete",t,e)}submit(t,e,s={}){return this.startProcessing(),s=d({data:{},params:{},url:this.route(e),method:t,onUploadProgress:this.handleUploadProgress.bind(this)},s),"get"===t.toLowerCase()?s.params=d(d({},this.data()),s.params):(s.data=d(d({},this.data()),s.data),y(s.data)&&!s.transformRequest&&(s.transformRequest=[t=>v.serialize(t)])),new Promise(((t,e)=>{(g.axios||r()).request(s).then((e=>{this.finishProcessing(),t(e)})).catch((t=>{this.handleErrors(t),e(t)}))}))}handleErrors(t){this.busy=!1,this.progress=void 0,t.response&&this.errors.set(this.extractErrors(t.response))}extractErrors(t){return t.data&&"object"==typeof t.data?t.data.errors?d({},t.data.errors):t.data.message?{error:t.data.message}:d({},t.data):{error:g.errorMessage}}handleUploadProgress(t){this.progress={total:t.total,loaded:t.loaded,percentage:Math.round(100*t.loaded/t.total)}}route(t,e={}){let s=t;return Object.prototype.hasOwnProperty.call(g.routes,t)&&(s=decodeURI(g.routes[t])),"object"!=typeof e&&(e={id:e}),Object.keys(e).forEach((t=>{s=s.replace(`{${t}}`,e[t])})),s}onKeydown(t){const e=t.target;e.name&&this.errors.clear(e.name)}}g.routes={},g.errorMessage="Something went wrong. Please try again.",g.recentlySuccessfulTimeout=2e3,g.ignore=["busy","successful","errors","progress","originalData","recentlySuccessful","recentlySuccessfulTimeoutId"];const w=g},8282:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(6828),r=s(2904),i=s(629),o=s(5714),n=s(8181),l=s(7565);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function u(t,e,s){return(e=function(t){var e=function(t,e){if("object"!==c(t)||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var a=s.call(t,e||"default");if("object"!==c(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===c(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const m={layout:"backend",middleware:["auth"],components:{ContentHeader:a.Z,ContentBody:r.Z,Notification:n.Z},metaInfo:function(){return{title:"Éxecution de la mission"}},data:function(){return{rowSelected:null,currentMetadata:{},isCompleted:!1,process:null,details:[],modals:{show:!1,edit:!1},form:new o.ZP(u({process_mode:!1,mission:null,process:null,media:[],detail:null,report:null,recovery_plan:null,score:null,major_fact:null,metadata:[]},"process_mode",null))}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){u(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({formErrorsCount:function(){return Object.entries(this.form.errors.all()).length}},(0,i.Se)({config:"details/config"})),breadcrumb:function(){var t;return{label:null===(t=this.process)||void 0===t?void 0:t.name}},created:function(){this.initData()},methods:{show:function(t){this.rowSelected=t,this.modals.show=!0,this.currentMetadata.keys=Object.keys(t.parsed_metadata)},edit:function(t){this.rowSelected=t,this.modals.edit=!0,this.currentMetadata.keys=Object.keys(t.parsed_metadata),this.initForm()},close:function(t){this.rowSelected=null,this.modals.hasOwnProperty(t)&&(this.modals[t]=!1),this.form.reset(),this.currentMetadata={}},initData:function(){var t=this;this.$store.dispatch("details/fetchConfig",{missionId:this.$route.params.missionId,processId:this.$route.params.processId}).then((function(){t.details=t.config.config.details,t.mission=t.config.config.mission,t.process=t.config.config.process,console.log(t.process),t.modals.show=!1,t.modals.edit=!1}))},initForm:function(){var t,e=this;this.$store.dispatch("details/fetchConfig",{missionId:this.$route.params.missionId,processId:this.$route.params.processId,detailId:null===(t=this.rowSelected)||void 0===t?void 0:t.id}).then((function(){var t=e.config.config;e.rowSelected=t.detail,e.form.process_mode=(0,l.nu)(["cc","cdcr"]),e.form.mission=e.$route.params.missionId,e.form.process=e.$route.params.processId,e.form.detail=t.detail.id,e.form.media=t.detail.media.length?t.detail.media.map((function(t){return t.id})):[],e.form.detail=t.detail.id,e.form.report=t.detail.report,e.form.recovery_plan=t.detail.recovery_plan,e.form.score=t.detail.score,e.form.major_fact=!!t.detail.major_fact,e.form.metadata=t.detail.metadata||[]}))},setupFields:function(t){return null==t?void 0:t.map((function(t){return{type:t.hasOwnProperty(0)?t[0].type:"",label:t.hasOwnProperty(1)?t[1].label:"",name:t.hasOwnProperty(2)?t[2].name:"",length:t.hasOwnProperty(3)?t[3].length:null,style:t.hasOwnProperty(4)?t[4].style:"",id:t.hasOwnProperty(5)?t[5].id:"",placeholder:t.hasOwnProperty(6)?t[6].placeholder:"",help_text:t.hasOwnProperty(7)?t[7].help_text:"",rules:t.hasOwnProperty(8)?t[8].rules:[]}}))},setupScores:function(t){return"object"==c(t)?null==t?void 0:t.map((function(t){return{id:t[0].score,label:t[1].label}})):[]},create:function(){var t=this;this.form.post("/api/missions/details/"+this.mission.id).then((function(e){e.data.status?(swal.toast_success(e.data.message),t.initData()):swal.alert_error(e.data.message)})).catch((function(t){var e=t.message;422==t.response.status&&(e="Les données fournies sont invalides."),swal.toast_error(e)}))},addRow:function(t){t=this.setupFields(t);for(var e=[],s=0;s<t.length;s++){var a,r=t[s],i=r.name,o=void 0!==r.default&&r.default;o=r.multiple?[]:"",e.push((u(a={},i,o),u(a,"label",r.label),u(a,"rules",r.rules),a))}this.form.metadata&&this.form.metadata.push(e)},removeRow:function(t,e){this.form.metadata.splice(e,1)},isInput:function(t){return["text","date","datetime","time","week","number","tel","email","month","url"].includes(t)}}};const f=(0,s(1900).Z)(m,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"can",rawName:"v-can",value:"view_mission_detail",expression:"'view_mission_detail'"}]},[e("ContentHeader",{scopedSlots:t._u([{key:"title",fn:function(){var s,a,r,i,o;return[e("div",{staticClass:"tags w-90"},[e("span",{staticClass:"tag is-info"},[t._v(t._s(null===(s=t.process)||void 0===s||null===(a=s.familly)||void 0===a?void 0:a.name))]),t._v(" "),e("span",{staticClass:"tag"},[t._v(t._s(null===(r=t.process)||void 0===r||null===(i=r.domain)||void 0===i?void 0:i.name))]),t._v(" "),e("span",{staticClass:"tag is-warning"},[t._v(t._s(null===(o=t.process)||void 0===o?void 0:o.name))])])]},proxy:!0}])}),t._v(" "),e("ContentBody",[e("div",{staticClass:"grid"},t._l(t.details,(function(s){var a,r,i,o;return e("div",{key:s.id,staticClass:"col-12"},[e("div",{staticClass:"box"},[e("div",{staticClass:"grid gap-4"},[e("div",{staticClass:"col-12"},[e("h3",[t._v(t._s(s.control_point.name))])]),t._v(" "),e("div",{staticClass:"col-4"},[e("b",[t._v("Fait majeur:")])]),t._v(" "),e("div",{staticClass:"col-8"},[s.major_fact?e("span",[e("i",{staticClass:"las la-times-circle icon text-danger"}),t._v("\n                Oui\n              ")]):e("span",[e("i",{staticClass:"las la-check-circle icon text-success"}),t._v("\n                Non\n              ")])]),t._v(" "),e("div",{staticClass:"col-4"},[e("b",[t._v("Appréciation:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s(s.appreciation))]),t._v(" "),e("div",{staticClass:"col-4"},[e("b",[t._v("Constat:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s(s.report||"-"))]),t._v(" "),e("div",{staticClass:"col-4"},[e("b",[t._v("Plan de redressement:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s(s.recovery_plan||"-"))]),t._v(" "),e("div",{staticClass:"col-12 d-flex justify-end align-center"},[e("div",{staticClass:"d-flex gap-2 align-center"},[e("button",{staticClass:"btn btn-info has-icon",on:{click:function(e){return t.show(s)}}},[e("i",{staticClass:"las la-eye icon"}),t._v("\n                  Voir plus\n                ")]),t._v(" "),null!==(a=t.mission)&&void 0!==a&&a.controller_opinion_validated?t._e():e("button",{directives:[{name:"can",rawName:"v-can",value:"control_agency",expression:"'control_agency'"}],staticClass:"btn btn-warning has-icon",on:{click:function(e){return t.edit(s)}}},[e("i",{staticClass:"las la-pen icon"}),t._v("\n                  Modifier\n                ")]),t._v(" "),null!==(r=t.mission)&&void 0!==r&&r.dre_report_validated?t._e():e("button",{directives:[{name:"can",rawName:"v-can",value:"create_dre_report,validate_dre_report",expression:"'create_dre_report,validate_dre_report'"}],staticClass:"btn btn-warning has-icon",on:{click:function(e){return t.edit(s)}}},[e("i",{staticClass:"las la-pen icon"}),t._v("\n                  Modifier\n                ")]),t._v(" "),null!==(i=t.mission)&&void 0!==i&&i.cdcr_validation_at?t._e():e("button",{directives:[{name:"can",rawName:"v-can",value:"make_first_validation",expression:"'make_first_validation'"}],staticClass:"btn btn-warning has-icon",on:{click:function(e){return t.edit(s)}}},[e("i",{staticClass:"las la-pen icon"}),t._v("\n                  Traiter\n                ")]),t._v(" "),null!==(o=t.mission)&&void 0!==o&&o.dcp_validation_at?t._e():e("button",{directives:[{name:"can",rawName:"v-can",value:"make_second_validation",expression:"'make_second_validation'"}],staticClass:"btn btn-warning has-icon",on:{click:function(e){return t.edit(s)}}},[e("i",{staticClass:"las la-pen icon"}),t._v("\n                  Traiter\n                ")]),t._v(" "),null!=s&&s.regularized_at?t._e():e("button",{directives:[{name:"can",rawName:"v-can",value:"regularize_mission_detail",expression:"'regularize_mission_detail'"}],staticClass:"btn btn-warning has-icon",on:{click:function(e){return t.edit(s)}}},[e("i",{staticClass:"las la-pen icon"}),t._v("\n                  Régulariser\n                ")])])])])])])})),0),t._v(" "),e("NLModal",{attrs:{show:t.modals.show},on:{close:function(e){return t.close("show")}},scopedSlots:t._u([{key:"title",fn:function(){var s;return[e("small",[t._v("\n          "+t._s(null===(s=t.rowSelected)||void 0===s?void 0:s.control_point.name)+"\n        ")])]},proxy:!0},{key:"default",fn:function(){var s,a,r,i,o,n,l,c,d,u;return[e("div",{staticClass:"grid list"},[e("div",{staticClass:"col-12 list-item"},[e("div",{staticClass:"list-item-content no-bg grid"},[e("div",{staticClass:"col-4"},[e("b",[t._v("Fait majeur:")])]),t._v(" "),e("div",{staticClass:"col-8"},[null!==(s=t.rowSelected)&&void 0!==s&&s.major_fact?e("span",[e("i",{staticClass:"las la-times-circle icon text-danger"}),t._v("\n                  Oui\n                ")]):e("span",[e("i",{staticClass:"las la-check-circle icon text-success"}),t._v("\n                  Non\n                ")])])])]),t._v(" "),e("div",{staticClass:"col-12 list-item"},[e("div",{staticClass:"list-item-content no-bg grid"},[e("div",{staticClass:"col-4"},[e("b",[t._v("Appréciation:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s(null===(a=t.rowSelected)||void 0===a?void 0:a.appreciation))])])]),t._v(" "),e("div",{staticClass:"col-12 list-item"},[e("div",{staticClass:"list-item-content no-bg grid"},[e("div",{staticClass:"col-4"},[e("b",[t._v("Constat:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s((null===(r=t.rowSelected)||void 0===r?void 0:r.report)||"-"))])])]),t._v(" "),e("div",{staticClass:"col-12 list-item"},[e("div",{staticClass:"list-item-content no-bg grid"},[e("div",{staticClass:"col-4"},[e("b",[t._v("Plan de redressement:")])]),t._v(" "),e("div",{staticClass:"col-8"},[t._v(t._s((null===(i=t.rowSelected)||void 0===i?void 0:i.recovery_plan)||"-"))])])]),t._v(" "),e("div",{staticClass:"col-12 list-item"},[e("div",{staticClass:"list-item-content no-bg grid"},[e("div",{staticClass:"col-12",class:{"col-lg-4":!(null!==(o=t.rowSelected)&&void 0!==o&&o.metadata)}},[e("b",[t._v("Informations supplémentaires:")])]),t._v(" "),e("div",{staticClass:"col-12",class:{"col-lg-8":!(null!==(n=t.rowSelected)&&void 0!==n&&n.metadata)}},[null!==(l=t.rowSelected)&&void 0!==l&&l.metadata?e("table",[e("thead",[e("tr",t._l(t.currentMetadata.keys,(function(s){return e("th",{staticClass:"text-left"},[t._v("\n                        "+t._s(s)+"\n                      ")])})),0)]),t._v(" "),e("tbody",t._l(null===(c=t.rowSelected)||void 0===c?void 0:c.metadata,(function(s,a){return e("tr",{key:"metadata-row-"+a},t._l(s,(function(s,a){return e("td",{key:"metadata-item-"+a,staticClass:"text-left"},t._l(s,(function(s,r){return"label"!==r&&"rules"!==r?e("span",{key:"metadata-item-"+a+"-content"},[t._v("\n                          "+t._s(s||"-")+"\n                        ")]):t._e()})),0)})),0)})),0)]):e("span",[t._v("-")])])])]),t._v(" "),null!==(d=t.rowSelected)&&void 0!==d&&d.media?e("div",{staticClass:"col-12 list-item"},t._l(null===(u=t.rowSelected)||void 0===u?void 0:u.media,(function(s){return e("div",{staticClass:"list-item-content",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"files-list list is-visible grid gap-4 text-medium"},[e("div",{staticClass:"col-11 d-flex justify-between align-center"},[e("a",{staticClass:"text-dark text-small",attrs:{href:s.link,target:"_blank"}},[t._v("\n                    "+t._s(s.original_name)+"\n                  ")]),t._v(" "),e("span",{staticClass:"text-small"},[t._v(t._s(s.size))])]),t._v(" "),e("div",{staticClass:"col-1 d-flex justify-end align-center gap-4"},[e("a",{attrs:{href:s.link,download:s.original_name}},[e("i",{staticClass:"las la-download text-info icon"})]),t._v(" "),e("i",{staticClass:"las la-trash text-danger icon is-clickable",on:{click:function(e){return e.stopPropagation(),t.deleteItem(s,t.index)}}})])])])})),0):t._e()])]},proxy:!0}])}),t._v(" "),t.modals.edit?e("NLModal",{attrs:{show:t.modals.edit,defaultMode:!0},on:{close:function(e){return t.close("edit")}},scopedSlots:t._u([{key:"title",fn:function(){var s;return[e("small",[t._v("\n          "+t._s(null===(s=t.rowSelected)||void 0===s?void 0:s.control_point.name)+"\n        ")])]},proxy:!0},{key:"default",fn:function(){var s,a,r;return[t.form.errors.any()?e("Notification",{attrs:{type:"is-danger"}},[t._v("\n          Il y a "+t._s(t.formErrorsCount)+"\n          "+t._s(t.formErrorsCount>1?"problèmes avec vos entrées":"problème avec une entrée")+".\n        ")]):t._e(),t._v(" "),e("form",{staticClass:"grid gap-2",attrs:{enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),t.create.apply(null,arguments)},keydown:function(e){return t.form.onKeydown(e)}}},[null!==(s=t.detail)&&void 0!==s&&s.control_point.has_major_fact?e("div",{staticClass:"col-12"},[e("NLSwitch",{attrs:{name:"major_fact",form:t.form,label:"Fait majeur"},model:{value:t.form.major_fact,callback:function(e){t.$set(t.form,"major_fact",e)},expression:"form.major_fact"}})],1):t._e(),t._v(" "),e("div",{staticClass:"col-12"},[e("NLSelect",{attrs:{name:"score",label:"Notation",form:t.form,options:t.setupScores(null===(a=t.rowSelected)||void 0===a?void 0:a.control_point.scores),labelRequired:""},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1),t._v(" "),null!==(r=t.rowSelected)&&void 0!==r&&r.control_point.fields&&t.form.score>1?e("div",{staticClass:"col-12"},[e("div",{staticClass:"repeater"},[e("h2",{staticClass:"mb-6"},[t._v("Informations supplémentaires")]),t._v(" "),t._l(t.form.metadata,(function(s,a){var r;return e("div",{key:"metadata-"+a,staticClass:"grid my-6 repeater-row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"grid gap-2"},[e("div",{staticClass:"col-11"},[e("div",{staticClass:"grid"},t._l(t.setupFields(null===(r=t.rowSelected)||void 0===r?void 0:r.control_point.fields),(function(s,r){return e("div",{key:"metadata-input-"+s.name+"-"+a+"-id",class:s.style},[t.isInput(s.type)?e("NLInput",{attrs:{form:t.form,label:s.label,placeholder:s.placeholder,type:s.type,labelRequired:s.required,name:"metadata."+a+"."+r+"."+s.name,id:"metadata."+a+"."+r+"."+s.name},model:{value:t.form.metadata[a][r][s.name],callback:function(e){t.$set(t.form.metadata[a][r],s.name,e)},expression:"form.metadata[dataRow][index][input.name]"}}):t._e(),t._v(" "),"textarea"==s.type?e("NLTextarea",{attrs:{form:t.form,label:s.label,placeholder:s.placeholder,type:s.type,labelRequired:s.required,name:"metadata."+a+"."+r+"."+s.name,id:"metadata."+a+"."+r+"."+s.name,length:s.length},model:{value:t.form.metadata[a][r][s.name],callback:function(e){t.$set(t.form.metadata[a][r],s.name,e)},expression:"form.metadata[dataRow][index][input.name]"}}):t._e(),t._v(" "),"wyswyg"==s.type?e("NLWyswyg",{attrs:{form:t.form,label:s.label,placeholder:s.placeholder,type:s.type,labelRequired:s.required,name:"metadata."+a+"."+r+"."+s.name,id:"metadata."+a+"."+r+"."+s.name,length:s.length},model:{value:t.form.metadata[a][r][s.name],callback:function(e){t.$set(t.form.metadata[a][r],s.name,e)},expression:"form.metadata[dataRow][index][input.name]"}}):t._e(),t._v(" "),"select"==s.type?e("NLSelect",{attrs:{form:t.form,label:s.label,type:s.type,labelRequired:s.required,name:"metadata."+a+"."+r+"."+s.name,id:"metadata."+a+"."+r+"."+s.name,options:s.options,placeholder:s.placeholder||"Choisissez une option...",multiple:s.multiple},model:{value:t.form.metadata[a][r][s.name],callback:function(e){t.$set(t.form.metadata[a][r],s.name,e)},expression:"form.metadata[dataRow][index][input.name]"}}):t._e()],1)})),0)]),t._v(" "),a>=0?e("div",{staticClass:"col-1 p-0 d-flex justify-start align-center"},[e("div",{staticClass:"btn btn-danger",on:{click:function(e){return t.removeRow(a)}}},[t._v("\n                        Supprimer\n                      ")])]):t._e()])])])})),t._v(" "),e("div",{staticClass:"d-flex justify-start align-center"},[e("span",{staticClass:"btn",on:{click:function(e){var s;return t.addRow(null===(s=t.rowSelected)||void 0===s?void 0:s.control_point.fields)}}},[e("i",{staticClass:"las la-plus"})])])],2)]):t._e(),t._v(" "),e("div",{staticClass:"col-12"},[e("NLTextarea",{attrs:{name:"report",label:"Constat",form:t.form,placeholder:1==t.form.score||null==t.form.score&&!t.form.major_fact?"":"Ajouter votre constat",labelRequired:t.form.score>1||t.form.major_fact,disabled:1==t.form.score||null==t.form.score&&!t.form.major_fact},model:{value:t.form.report,callback:function(e){t.$set(t.form,"report",e)},expression:"form.report"}})],1),t._v(" "),e("div",{staticClass:"col-12"},[e("NLFile",{attrs:{name:"media",label:"Pièces jointes",attachableType:"App\\Models\\MissionDetail",attachableId:t.form.detail,form:t.form,multiple:""},model:{value:t.form.media,callback:function(e){t.$set(t.form,"media",e)},expression:"form.media"}})],1),t._v(" "),e("div",{staticClass:"col-12"},[e("NLTextarea",{attrs:{name:"recovery_plan",label:"Plan de redressement",form:t.form,placeholder:1==t.form.score||null==t.form.score&&!t.form.major_fact?"":"Ajouter votre plan de redressement",labelRequired:t.form.score>1||t.form.major_fact,disabled:1==t.form.score||null==t.form.score&&!t.form.major_fact},model:{value:t.form.recovery_plan,callback:function(e){t.$set(t.form,"recovery_plan",e)},expression:"form.recovery_plan"}})],1),t._v(" "),e("div",{staticClass:"d-flex justify-end align-center"},[t.form.process_mode?e("NLButton",{staticClass:"is-radius",attrs:{loading:t.form.busy,label:"Validate"}}):e("NLButton",{staticClass:"is-radius",attrs:{loading:t.form.busy,label:"Save"}})],1)])]},proxy:!0}],null,!1,160331940)}):t._e()],1)],1)}),[],!1,null,null,null).exports}}]);