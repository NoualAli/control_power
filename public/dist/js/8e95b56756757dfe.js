"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[432],{4432:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});var a=s(2376),n=s(2904),i=s(629);const o={components:{ContentHeader:a.Z,ContentBody:n.Z},layout:"backend",middleware:["auth"],metaInfo:function(){return{title:"Suivi des réalisations des missions"}},data:function(){return{rowSelected:null,campaignId:null,config:{data:null,namespace:"missions",state_key:"paginated",rowKey:"id",search:!0,columns:[{label:"CDC-ID",field:"campaign"},{label:"Référence",field:"reference"},{label:"Dre",field:"dre"},{label:"Agence",field:"agency"},{label:"Contrôle sur place par",field:"controllers_str"},{label:"Date début",field:"start"},{label:"Date fin",field:"end"},{label:"Moyenne",field:"avg_score",methods:{style:function(t){var e=t.avg_score;return 1==e?"bg-success text-white text-bold":2==e?"bg-info text-white text-bold":3==e?"bg-warning text-bold":"bg-danger text-white text-bold"}}},{label:"État",field:"state",methods:{style:function(t){return"EN COURS"==t.state?"bg-warning text-bold text-small":"À RÉALISER"==t.state?"bg-info text-white text-bold text-small":"RÉALISÉ"==t.state?"bg-success text-white text-bold text-small":"EN RETARD"==t.state?"bg-danger text-white text-bold text-small":"Validé et envoyé"==t.state?"bg-success text-white text-bold text-small":"En attente de validation"==t.state?"bg-danger text-white text-bold text-small":void 0}}},{label:"Progression",field:"progress_status",methods:{showField:function(t){return t.progress_status+"%"}}}],actions:{show:function(t){return user().authorizations.view_mission},edit:function(t){return user().authorizations.edit_mission&&t.remaining_days_before_start>5},delete:function(t){return user().authorizations.delete_mission&&t.remaining_days_before_start>5}}}}},computed:(0,i.Se)({missions:"missions/paginated"}),created:function(){this.campaignId=this.$route.params.campaignId,this.initData()},methods:{initData:function(){var t=this;(this.$route.params.campaignId?this.$store.dispatch("missions/fetchPaginated",this.$route.params.campaignId):this.$store.dispatch("missions/fetchPaginated")).then((function(){return t.config.data=t.missions.paginated}))},show:function(t){this.$router.push({name:"mission",params:{missionId:t.id}})},edit:function(t){this.$router.push({name:"missions-edit",params:{missionId:t.id}})},destroy:function(t){var e=this;swal.confirm_destroy().then((function(s){s.isConfirmed&&api.delete("missions/"+t.id).then((function(t){t.data.status?(e.initData(),swal.toast_success(t.data.message)):swal.alert_error(t.data.message)})).catch((function(t){console.log(t)}))}))}}};const r=(0,s(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"can",rawName:"v-can",value:"view_mission",expression:"'view_mission'"}]},[t.campaignId?e("ContentHeader",{scopedSlots:t._u([{key:"actions",fn:function(){return[e("router-link",{directives:[{name:"can",rawName:"v-can",value:"create_mission",expression:"'create_mission'"}],staticClass:"btn btn-info",attrs:{to:{name:"missions-create",params:{campaignId:t.campaignId}}}},[t._v("\n        Ajouter\n      ")])]},proxy:!0}],null,!1,1288940108)}):t._e(),t._v(" "),e("ContentBody",[e("NLDatatable",{attrs:{config:t.config},on:{show:t.show,delete:t.destroy,edit:t.edit}})],1)],1)}),[],!1,null,null,null).exports}}]);